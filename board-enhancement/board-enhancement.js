parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"loFf":[function(require,module,exports) {
const e="gds",t={CARD:"board-card",CARD_ACTIVE:"is-active",CARD_GHOST:"is-ghost"},s={COLLAPSED_STATE:"gds--collapsed",IFRAME:"gds-iframe",IFRAME_LOADING:"gds-iframe--loading",SIDEBAR:"gds-sidebar",SIDEBAR_HEADER:"gds-sidebar-header",SPINNER:"gds-loading-spinner",TOGGLE:"gds-expanded-toggle",TOGGLE_COLLAPSED:"gds-expanded-toggle--collapsed",TOGGLE_STYLES:"btn btn-default btn-sm gl-button btn-default-tertiary btn-icon"},i={BOARD:".boards-list",CARD:`.${t.CARD}`,IFRAME:`.${s.IFRAME}`,LINK:".board-card-title a",NEW_ISSUE_BUTTON:".issue-count-badge-add-button",NUMBER:".board-card-number",SIDEBAR:".boards-sidebar",SIDEBAR_HEADER:".gl-drawer-header"},a="gitlab-sidebar-expanded-state",r=(e,t)=>{let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>e(...i),t)}};class n{constructor(e){e&&(this.element=e,this.sidebar=null,this.sidebarHeader=null,this.frame=null,this.toggle=null,this.cardList={},this.observer=null,this.clickHandler=this.clickHandler.bind(this),this.getCardLink=this.getCardLink.bind(this),this.getCardNumber=this.getCardNumber.bind(this),this.onBoardMutation=this.onBoardMutation.bind(this),this.setIssue=this.setIssue.bind(this),this.setUIState=this.setUIState.bind(this),this.styleFrame=this.styleFrame.bind(this),this.toggleExpansion=this.toggleExpansion.bind(this),this.setSidebarClasses=this.setSidebarClasses.bind(this),this.setIssueDebounced=r(this.setIssue,1),this.expanded="false"!==localStorage.getItem(a),this.bindEvents(),console.debug("GitLab Details Sidebar Plugin initialised..."))}bindEvents(){this.element.addEventListener("click",this.clickHandler)}unbindEvents(){this.element.removeEventListener("click",this.clickHandler),this.observer.disconnect()}clickHandler(e){if(e.target.closest(i.NEW_ISSUE_BUTTON))return void(this.observer||this.watchForNewCards());const t=e.target.closest(i.CARD);if(!t||e.target.closest(i.LINK))return;const s=this.getCardLink(t);s&&this.setIssue(s)}getSidebar(){const e=document.querySelectorAll(i.SIDEBAR);return e[e.length-1]}setSidebarClasses(){this.sidebar&&this.sidebar.classList.add(s.SIDEBAR)}rebuildUI(){this.sidebar=this.getSidebar(),this.sidebarHeader=this.sidebar.querySelector(i.SIDEBAR_HEADER),this.sidebar.classList.add(s.SIDEBAR),this.sidebar.addEventListener("transitionend",this.setSidebarClasses),this.sidebarHeader.classList.add(s.SIDEBAR_HEADER),this.toggle&&(this.toggle.parentElement.removeChild(this.toggle),this.toggle=null);const e=document.querySelector(i.IFRAME);e&&e.parentElement.removeChild(e),this.frame=null,this.createFrame()}getCardLink(e){const t=e.querySelector(i.LINK);if(t)return t.href;console.warn("No link found on the current card.")}getCardNumber(e){const t=e.querySelector(i.NUMBER);if(t)return t.textContent.trim().replace("#","");console.warn("No number found on the current card.")}setIssue(e){console.log(`Setting iframe URL to: ${e}`),this.rebuildUI(),this.frame.classList.add(s.IFRAME_LOADING),this.frame.src=e}createFrame(){if(this.frame=document.createElement("iframe"),document.querySelector(i.IFRAME))return console.warn("GitLab Details Sidebar appears to have been initialised twice"),void this.destroy();this.toggle=document.createElement("button"),this.frame.addEventListener("load",this.styleFrame),this.toggle.addEventListener("click",this.toggleExpansion);const e=document.createElement("div"),t=document.createElement("span"),a=this.sidebar.firstElementChild;e.appendChild(t),e.appendChild(this.toggle),e.appendChild(this.frame),e.className=s.IFRAME,t.className=s.SPINNER,this.toggle.className=`${s.TOGGLE} ${s.TOGGLE_STYLES}`,this.toggle.ariaLabel="Toggle Sidebar Details View",this.toggle.title="Toggle Sidebar Details View",this.sidebar.insertBefore(e,a);const r=this.sidebarHeader.querySelector("button");r?r.parentNode.insertBefore(this.toggle,r):this.sidebarHeader.appendChild(this.toggle),this.setUIState()}styleFrame(){const e=document.createElement("style");e.textContent="\n      .navbar,\n      .alert-wrapper,\n      .right-sidebar,\n      .nav-sidebar,\n      .issuable-gutter-toggle,\n      .issue-sticky-header {\n        display: none !important;\n      }\n\n      .content-wrapper {\n        margin-top: 0 !important;\n        padding-right: 0 !important;\n      }\n\n      .layout-page.page-gutter {\n        padding-left: 0 !important;\n      }\n    ";const t=document.createElement("base");t.setAttribute("target","_top");try{const s=this.frame.contentWindow.document;s.head.appendChild(e),s.head.appendChild(t),[...s.querySelectorAll("a")].filter(e=>"_self"===e.target).forEach(e=>e.target="_top")}catch(i){console.warn("GitLab Details Sidebar was unable to style the child frame."),console.debug(i)}this.frame.classList.remove(s.IFRAME_LOADING)}toggleExpansion(){this.expanded=!this.expanded,localStorage.setItem(a,`${this.expanded}`),this.setUIState()}setUIState(){this.expanded?(this.toggle.classList.remove(s.TOGGLE_COLLAPSED),document.body.classList.remove(s.COLLAPSED_STATE)):(this.toggle.classList.add(s.TOGGLE_COLLAPSED),document.body.classList.add(s.COLLAPSED_STATE))}watchForNewCards(){this.observer=new MutationObserver(this.onBoardMutation),this.observer.observe(this.element,{attributes:!1,childList:!0,subtree:!0})}onBoardMutation(e){e.filter(e=>{if("childList"!==e.type||1!==e.addedNodes.length)return!1;const s=e.addedNodes[0];return s.classList&&s.classList.contains(t.CARD)&&!s.classList.contains(t.CARD_GHOST)&&"false"!==s.getAttribute("draggable")}).forEach(e=>{const t=e.addedNodes[0],s=this.getCardNumber(t);if(this.cardList[s])return;if(this.cardList[s]=!0,s<Math.max(...Object.keys(this.cardList)))return;const i=this.getCardLink(t);i&&this.setIssueDebounced(i)})}destroy(){this.unbindEvents(),this.element=null,this.sidebar=null,this.sidebarHeader=null}}module.exports={BoardEnhancement:n,CLASSES:t,CUSTOM_CLASSES:s,LOCAL_STORAGE_KEY:a,NAMESPACE:"gds",SELECTORS:i};
},{}],"JPSt":[function(require,module,exports) {
const e={CARD:"board-card",CARD_ACTIVE:"is-active",CARD_GHOST:"is-ghost",IFRAME:"sidebar-iframe",IFRAME_LOADING:"sidebar-iframe--loading",LEGACY_TOP_LEVEL_CLASS:"gitlab-details-sidebar--legacy",SIDEBAR_COLLAPSED:"gitlab-sidebar-detail--collapsed",SPINNER:"gitlab-sidebar-loading-spinner",TOGGLE:"gitlab-sidebar-expanded-toggle",TOGGLE_COLLAPSED:"gitlab-sidebar-expanded-toggle--collapsed"},t={BOARD:".boards-list",CARD:`.${e.CARD}`,IFRAME:`.${e.IFRAME}`,LINK:".board-card-title a",NUMBER:".board-card-number",SIDEBAR:".boards-sidebar",SIDEBAR_HEADER:".issuable-sidebar-header",SIDEBAR_LEGACY:".issue-boards-sidebar"},s="gitlab-sidebar-expanded-state",i=(e,t)=>{let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>e(...i),t)}};class a{constructor(a){a&&(this.element=a,this.sidebar=document.querySelector(t.SIDEBAR)||document.querySelector(t.SIDEBAR_LEGACY),this.sidebarHeader=this.sidebar.querySelector(t.SIDEBAR_HEADER),this.frame=null,this.toggle=null,this.cardList={},this.firstRun=!0,this.clickHandler=this.clickHandler.bind(this),this.getCardLink=this.getCardLink.bind(this),this.getCardNumber=this.getCardNumber.bind(this),this.onBoardMutation=this.onBoardMutation.bind(this),this.setIssue=this.setIssue.bind(this),this.setUIState=this.setUIState.bind(this),this.styleFrame=this.styleFrame.bind(this),this.toggleExpansion=this.toggleExpansion.bind(this),this.setIssueDebounced=i(this.setIssue,1),this.expanded="false"!==localStorage.getItem(s),this.observer=new MutationObserver(this.onBoardMutation),document.documentElement.classList.add(e.LEGACY_TOP_LEVEL_CLASS),this.bindEvents(),console.debug("GitLab Details Sidebar Plugin initialised..."))}bindEvents(){this.element.addEventListener("click",this.clickHandler),this.observer.observe(this.element,{attributes:!1,childList:!0,subtree:!0})}unbindEvents(){this.element.removeEventListener("click",this.clickHandler),this.observer.disconnect()}clickHandler(e){const s=e.target.closest(t.CARD);if(!s||e.target.closest(t.LINK))return;const i=this.getCardLink(s);i&&this.setIssue(i)}getCardLink(e){const s=e.querySelector(t.LINK);if(s)return s.href;console.warn("No link found on the current card.")}getCardNumber(e){const s=e.querySelector(t.NUMBER);if(s)return s.textContent.trim().replace("#","");console.warn("No number found on the current card.")}setIssue(t){this.firstRun?this.firstRun=!1:(console.log(`Setting iframe URL to: ${t}`),this.frame||this.createFrame(),this.frame.classList.add(e.IFRAME_LOADING),this.frame.src=t)}createFrame(){if(this.frame=document.createElement("iframe"),document.querySelector(t.IFRAME))return console.warn("GitLab Details Sidebar appears to have been initialised twice"),void this.destroy();this.toggle=document.createElement("button"),this.frame.addEventListener("load",this.styleFrame),this.toggle.addEventListener("click",this.toggleExpansion);const s=document.createElement("div"),i=document.createElement("span"),a=this.sidebar.firstElementChild;s.appendChild(i),s.appendChild(this.toggle),s.appendChild(this.frame),s.className=e.IFRAME,i.className=e.SPINNER,this.toggle.className=e.TOGGLE,this.toggle.ariaLabel="Toggle Sidebar Details View",this.toggle.title="Toggle Sidebar Details View",this.sidebar.insertBefore(s,a),this.sidebarHeader.appendChild(this.toggle),this.setUIState()}styleFrame(){const t=document.createElement("style");t.textContent="\n      .navbar,\n      .alert-wrapper,\n      .right-sidebar,\n      .nav-sidebar,\n      .issuable-gutter-toggle {\n        display: none !important;\n      }\n\n      .content-wrapper {\n        margin-top: 0 !important;\n        padding-right: 0 !important;\n      }\n\n      .layout-page.page-gutter {\n        padding-left: 0 !important;\n      }\n    ";const s=document.createElement("base");s.setAttribute("target","_top");try{const e=this.frame.contentWindow.document;e.head.appendChild(t),e.head.appendChild(s),[...e.querySelectorAll("a")].filter(e=>"_self"===e.target).forEach(e=>e.target="_top")}catch(i){console.warn("GitLab Details Sidebar was unable to style the child frame."),console.debug(i)}this.frame.classList.remove(e.IFRAME_LOADING)}toggleExpansion(){this.expanded=!this.expanded,localStorage.setItem(s,`${this.expanded}`),this.setUIState()}setUIState(){this.expanded?(this.toggle.classList.remove(e.TOGGLE_COLLAPSED),document.body.classList.remove(e.SIDEBAR_COLLAPSED)):(this.toggle.classList.add(e.TOGGLE_COLLAPSED),document.body.classList.add(e.SIDEBAR_COLLAPSED))}onBoardMutation(t){t.filter(t=>{if("childList"!==t.type||1!==t.addedNodes.length)return!1;const s=t.addedNodes[0];return s.classList&&s.classList.contains(e.CARD)&&!s.classList.contains(e.CARD_GHOST)&&"false"!==s.getAttribute("draggable")}).forEach(e=>{const t=e.addedNodes[0],s=this.getCardNumber(t);if(this.cardList[s])return;if(this.cardList[s]=!0,s<Math.max(...Object.keys(this.cardList)))return;const i=this.getCardLink(t);i&&this.setIssueDebounced(i)})}destroy(){this.unbindEvents(),this.element=null,this.sidebar=null,this.sidebarHeader=null}}module.exports={BoardEnhancementLegacy:a};
},{}],"NfTd":[function(require,module,exports) {
"use strict";var e=require("./_board-enhancement.class"),n=require("./_board-enhancement.legacy");const r=document.querySelector(e.SELECTORS.BOARD),a=document.querySelector(".vue-portal-target");if(a){new e.BoardEnhancement(r)}else{new n.BoardEnhancementLegacy(r)}
},{"./_board-enhancement.class":"loFf","./_board-enhancement.legacy":"JPSt"}]},{},["NfTd"], null)